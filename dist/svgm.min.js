var svgm=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t){e.exports=SVGJS},function(e,t){e.exports=window},function(e,t){},function(e,t,r){"use strict";r.r(t);var a=r(0);var n="measure";function c(e,t,r){var a=o(e).label;if("scalebar"===a)return a;var c=e.type,l=e.attr().id,s={type:c,id:l,label:a},u=function(e,t,r,a){var c=e.type,o=t.split("-"),l={rect:["w","h","area","p","c"],ellipse:["area","w","h","p","c"],circle:["area","w","h","c","diameter"],path:["area","l","h"],line:["l","h"],text:["t","y"],image:["file","folder"],g:["count","d","area"]};if(!l[c])return!1;var s=function(e,t){for(var r=0,a=[],n=0;n<t.length;n++)(r=e.indexOf(t[n]))>=0&&a.push(e[r]);return a}(o,l[c]);0===s.length&&(s={measure:{rect:["w","h"],ellipse:["w","h"],circle:["diameter"],path:["l"],line:["l"],text:["t"],image:["file","folder"],g:["count","d"]},strat:{ellipse:["c"],circle:["c"],line:["h","start"],path:["h","start"],text:["t","y"],g:["count"]}}[n][c]);if(!s)return!1;var u={};return s.forEach(function(t){u[t]=function(e,t,r,a){var n,c,o=e.attr(),l=0;switch(t){case"ellipse-c":l={x:e.cx()/r,y:e.cy()/r};break;case"ellipse-w":l=e.width()/r;break;case"ellipse-h":l=e.height()/r;break;case"line-l":case"line-h":var s=e.array().value,u=s[0],f=s[1];l=i(u,f)/r;break;case"line-start":var h=e.attr("x1"),m=e.attr("y1"),v=e.attr("y2");v>m&&(m=v),l={x:h,y:m};break;case"circle-c":l={x:e.cx()/r,y:e.cy()/r};break;case"circle-diameter":l=e.height()/r;break;case"rect-start":l={x:e.x()/r,y:e.y()/r};break;case"rect-c":l={x:e.cx()/r,y:e.cy()/r};break;case"rect-area":l=o.width*o.height/(r*r);break;case"rect-l":l=o.height/r;break;case"rect-w":l=e.width()/r;break;case"rect-h":l=e.height()/r;break;case"circle-area":var p=e.height()/2;l=Math.PI*(p*p)/(r*r);break;case"path-start":arrayPoints=e.array().value;var m=arrayPoints[0][2],h=0,d=arrayPoints.length;arrayPoints.forEach(function(e){m<e[2]&&(m=e[2]),h+=e[1]}),l={x:(h/=d)/r,y:m/r};break;case"path-h":l=e.length()/r;break;case"path-area":n=e.node,(c=function(e,t,r){t||(t=1e-4),r||(r=3);for(var a=function e(a,n){for(var c=[a],i=1,l=(n.d-a.d)/r;i<r;i++)c[i]=o(a.d+l*i);if(c.push(n),function(e){for(var t,r,a=0,n=e.length,c=0;c<n;++c)t=e[c],r=e[(c-1+n)%n],a+=(r.x+t.x)*(r.y-t.y);return Math.abs(a/2)}(c)<=t)return[a,n];for(var s=[],i=1;i<c.length;++i){var u=e(c[i-1],c[i]);u.pop(),s=s.concat(u)}return s.push(n),s}(o(0),o(e.getTotalLength())),n=a.length;n--;)a[n]=[a[n].x,a[n].y];var c=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return c.setAttribute("points",a.join(" ")),c;function o(t){var r=e.getPointAtLength(t);return r.d=t,r}}(n,0)).points.numberOfItems,l=function(e){for(var t=0,r=e.points,a=r.numberOfItems,n=0;n<a;++n){var c=r.getItem(n),o=r.getItem((n+a-1)%a);t+=(o.x+c.x)*(o.y-c.y)}return Math.abs(t/2)}(c)/(r*r);break;case"path-l":l=e.length()/r;break;case"text-t":if(e.node.childNodes.length>1){var b=a.select("tspan",e.node).members[0].node.textContent,g=a.select("desc",e.node).members[0],y=a.select("title",e.node).members[0],x="",k="";g&&(x="-"+g.node.textContent),y&&(k="-"+y.node.textContent);var l=b+k+x}else var l=e.text();break;case"text-y":l=e.attr("y")/r;break;case"image-file":var w=o["xlink:href"].split("/");l=w[w.length-1].split(".")[0];break;case"image-folder":var w=o["xlink:href"].split("/");l=w[w.length-2];break;case"g-d":var E=e.select("rect").members[0];if(E)var O=E.attr(),P=O.width*O.height/(r*r);var M=e.children().length-1;l=M/P;break;case"g-count":l=e.children().length-1}return l||"нет измерений"}(e,c+"-"+t,r,a)}),u}(e,l,t,r);u&&(s.measures=u);var f=r.select("desc",e.node).members[0],h=r.select("title",e.node).members[0];return f&&(s.desc=f.node.textContent),h&&(s.title=h.node.textContent),s}function o(e){var t=e.attr(),r=t["inkscape:label"];if(!r)return{label:t.id};var a=r.split("=");return{label:a[0],labelvalue:a[1]}}function i(e,t){var r=e[0],a=t[0],n=e[1],c=t[1];return Math.sqrt((a-=r)*a+(c-=n)*c)}function l(e){var t=[];return e.forEach(function(e){var r=function(e){var t={path:function(e,t){var r=e.node.getAttribute("d"),a=r.indexOf("z"),n=e.length();return a>0&&(alert("Масштабный отрезок в виде закрытой кривой! Это может привести к ошибочным вычислениям. Исправьте отрезок или используйте прямоугольник (rectangles) для масштабного отрезка"),n=e.length()/2),n/t},line:function(e,t){var r=e.array().value,a=r[0],n=r[1],c=function(e,t){var r=e[0],a=t[0],n=e[1],c=t[1];return Math.sqrt((a-=r)*a+(c-=n)*c)}(a,n);return c/t},rect:function(e,t){var r=e.width(),a=e.height();return a>r&&(r=a),r/t}},r=e.type,a=o(e);if("scalebar"===a.label){var n=Number(a.labelvalue),c=t[r](e,n);return c}return!1}(e);r&&t.push({item:e,scalefactor:r})}),t}function s(e,t){var r=[];return e.forEach(function(e,a){r.push(function(e,t){var r={scalefactor:e.scalefactor,elements:{image:[],text:[],path:[],line:[],rect:[],ellipse:[],circle:[],g:[]}};return e.group.children().forEach(function(a){var n=c(a,e.scalefactor,t);"scalebar"!=n&&r.elements[n.type]&&r.elements[n.type].push(n)}),r}(e,t))}),r}var u=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=r(1),c=a(n),o=c(n.document.documentElement);return""==t&&(e="./assets/test.svg",t=r(2).readFileSync(e,"utf8")),o.svg(t),c};var f=function(e,t){var r=s(function(e){var t=l(e.select("path").members),r=l(e.select("rect").members);r&&(t=t.concat(r));var a=l(e.select("line").members);a&&(t=t.concat(a));var n=[];return t&&t.forEach(function(e){var t=e.item.parent();n.push({group:t,scalefactor:e.scalefactor})}),n}(u=u(e)),u);return console.log("from index:",r),function(e,t){var r=[];return e.forEach(function(e){var t=function(e){var t=e.elements,r={scalefactor:e.scalefactor},a=[];t.text.forEach(function(e){"name"===e.label&&(r.name=e.measures.t),"comments"!==e.label&&"comment"!==e.label||(r.comments=e.measures.t)}),t.image.forEach(function(e){r.imagefilename=e.measures.file,r.imagefoldername=e.measures.folder}),r.name||(r.name=r.imagefilename);var a=[];return t.path.forEach(function(e){a=a.concat(n(e))}),t.line.forEach(function(e){a=a.concat(n(e))}),t.rect.forEach(function(e){a=a.concat(n(e))}),t.ellipse.forEach(function(e){a=a.concat(n(e))}),t.circle.forEach(function(e){a=a.concat(n(e))}),t.g.forEach(function(e){a=a.concat(n(e))}),a;function n(e){r.scalefactor;var t=[];for(var a in e.measures){var n=e.measures[a];"number"==typeof n&&n>1&&(n=n.toFixed(2));var c={name:r.name,type:e.type+"-"+a,label:e.label,value:n,title:e.title||"",description:e.desc||"",comments:r.comments||""};t.push(c)}return t}}(e);r=r.concat(t)}),r.map(function(e,r,a){return e.filename=t,a[r]=e})}(r)}("");console.log(f)}]);